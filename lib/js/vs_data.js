!function(window,undefined){function RSSEnclosure(e){e?(this.url=e.getAttribute("url"),this.length=e.getAttribute("length"),this.type=e.getAttribute("type")):(this.url=null,this.length=null,this.type=null)}function RSSGuid(e){e?(this.isPermaLink=e.getAttribute("isPermaLink"),this.value=e.textContent):(this.isPermaLink=null,this.value=null)}function RSSSource(e){e?(this.url=e.getAttribute("url"),this.value=e.textContent):(this.url=null,this.value=null)}function RSSItem(e){for(var t=["title","link","description","author","comments","pubDate"],i=["_title","_link","_description","_author","_comments","_pub_date"],r=null,n=0;n<t.length;n++)(r=e.getElementsByTagName(t[n])[0])&&(this[i[n]]=r.textContent);this._category=new RSSCategory(e.getElementsByTagName("category")[0]),this._enclosure=new RSSEnclosure(e.getElementsByTagName("enclosure")[0]),this._guid=new RSSGuid(e.getElementsByTagName("guid")[0]),this._source=new RSSSource(e.getElementsByTagName("source")[0]),this._image=new RSSImage(e.getElementsByTagName("content")[0]),this._image&&(this._image_url=this.image.url)}function RSSCategory(e){e?(this.domain=e.getAttribute("domain"),this.value=e.textContent):(this.domain=null,this.value=null)}function RSSImage(e){if(e){imgAttribs=["url","title","link","width","height","description"];for(var t=0;t<imgAttribs.length;t++)e.getAttribute(imgAttribs[t])&&(this[imgAttribs[t]]=e.getAttribute(imgAttribs[t]))}else this.url=null,this.link=null,this.width=null,this.height=null,this.description=null}function RSSChannel(e,t){if(e._items=[],!t)return console.error("Failed to parse rss document that is null."),!1;for(var i=t.getElementsByTagName("channel")[0],r=t.getElementsByTagName("item"),n=0;n<r.length;n++)Item=new RSSItem(r[n]),e._items.push(Item);for(var o=["_title","_link","_description","_language","_copyright","_managing_editor","_web_master","_pub_date","_last_build_date","_generator","_docs","_ttl","_rating"],s=["title","link","description","language","copyright","managingEditor","webMaster","pubDate","lastBuildDate","generator","docs","ttl","rating"],a=null,n=0;n<s.length;n++)(a=i.getElementsByTagName(s[n])[0])&&(e[o[n]]=a.textContent);e._category=new RSSCategory(i.getElementsByTagName("category")[0]),e._image=new RSSImage(i.getElementsByTagName("image")[0])}function _performAlternateYahooPipeRequest(){var e=(new core.AjaxJSONP).init();e.url="http://pipes.yahoo.com/pipes/pipe.run?_id=9oyONQzA2xGOkM4FqGIyXQ&_render=json&feed="+escape(this._url),e.clbParamName="_callback",e.bind("jsonload",this,function(e){var t=e.data;if(t&&t.value&&t.value.items){var i=t.value;this._pub_date=i.pubDate,this._items=[],itemElements=i.items;for(var r=0;r<itemElements.length;r++)this._items.push(itemElements[r]);this.propagate("rssload",this),this.outPropertyChange()}else this.propagate("rssloaderror","document null.")}),e.bind("loaderror",this,function(e){this.propagate("rssloaderror")}),e.send()}function URL(e){this.parent=core.Object,this.parent(e),this.constructor=URL}var document=window.document,vs=window.vs,util=vs.util,core=vs.core,data=vs.data,GoogleSearch=function(e){this.parent=core.EventSource,this.parent(e),this.constructor=GoogleSearch,GoogleSearch.loadService(this),this.ERROR_CODE=0,this._addresses=[],this._position=[]};GoogleSearch.loadService=function(e){if(!GoogleSearch.__google_loaded__){if(!GoogleSearch.__google_wait_loaded__){GoogleSearch.__google_wait_loaded__=!0;var t="http://www.google.com/jsapi?key="+GoogleSearch.key+"&callback=vs.data.GoogleSearch.__on_loaded";util.importFile(t,null,null,"js")}e&&GoogleSearch._to_finish_init.push(e)}},GoogleSearch.key=" ABQIAAAAE4BGaIh0t-7l9PDR7PA0rRR6KW34AlT62yZeC298tyhOjAL-9hQQpk22pW6ZfaCFEr3zjz2Q8rjqAw",GoogleSearch.__google_wait_loaded__=!1,GoogleSearch.__google_loaded__=!1,GoogleSearch._to_finish_init=new Array,GoogleSearch.LOCAL_SEARCH_ENGINE=1,GoogleSearch.VIDEO_SEARCH_ENGINE=2,GoogleSearch.__on_loaded=function(){google.load("search","1",{nocss:!0,callback:vs.data.GoogleSearch.__on_search_loaded})},GoogleSearch.__on_search_loaded=function(){var e,t;for(GoogleSearch.__google_loaded__=!0,GoogleSearch.__google_wait_loaded__=!1,e=0,t=GoogleSearch._to_finish_init.length;e<t;e++)GoogleSearch._to_finish_init[e].finishInit();GoogleSearch._to_finish_init=null},GoogleSearch.ERROR_CODE_STR=["No error","Unknown error","Unvalid parameters data","Error with google server","Connexion error","Unvalid google response"],GoogleSearch.prototype={__local_search:undefined,__video_search:undefined,__init_ok:!1,__engine_to_init:0,__end_init_clb:null,_engine_loaded:!1,_str_address:"",_addresses:null,_position:null,finishInit:function(){this.__init_ok=!0,this.__engine_to_init&&(this.setSearchEngine(this.__engine_to_init),this.__engine_to_init=0)},setSearchEngine:function(e){this.__init_ok?(e|GoogleSearch.LOCAL_SEARCH_ENGINE&&!this.__local_search&&(this.__local_search=new google.search.LocalSearch,this.__local_search.setResultSetSize(google.search.Search.SMALL_RESULTSET),this.__local_search.setNoHtmlGeneration()),e|GoogleSearch.VIDEO_SEARCH_ENGINE&&!this.__video_search&&(this.__video_search=new google.search.VideoSearch,this.__video_search.setResultSetSize(google.search.Search.SMALL_RESULTSET),this.__video_search.setNoHtmlGeneration()),this._engine_loaded=!0,this.propagate("engineload"),this.outPropertyChange("engineLoaded")):this.__engine_to_init=e},_newGoogleLocalSearch:function(e,t){var i=this;if(this.__local_search.setSearchCompleteCallback(this,function(){t.call(i,i.__local_search.results)}),!e||"string"!=typeof e)return this.ERROR_CODE=2,void t.call(i,null);this.__local_search.execute(e)},_googleLocalSearch:function(data,clb){if(this.__local_search)this._newGoogleLocalSearch(data,clb);else{if(!data||"string"!=typeof data)return this.ERROR_CODE=2,void clb.call(this,null);var url="http://ajax.googleapis.com/ajax/services/search/local?v=1.0&q="+data,xmlhttp=new XMLHttpRequest;if(xmlhttp.open("GET",url,!1),xmlhttp.send(null),4===xmlhttp.readyState){var coord_data=eval("("+xmlhttp.responseText+")");return 200!==coord_data.responseStatus?(this.ERROR_CODE=3,void clb.call(this,null)):coord_data.responseData?void clb.call(this,coord_data.responseData):(this.ERROR_CODE=5,void clb.call(this,null))}this.ERROR_CODE=4,clb.call(this,null)}},GPSCoordinateToAddress:function(e,t,i){if(this.__local_search){if(i||(i=this),!e||!e.length)return this.ERROR_CODE=2,void t.call(i,null);var r=e[0]+","+e[1],n=this;this._googleLocalSearch(r,function(e){if(!e)return this.ERROR_CODE=5,void t.call(i,null);if(0===e.length||!e[0])return this.ERROR_CODE=5,void t.call(i,null);n._addresses=[];var r={title:"",addressLine:"",streetAddress:"",city:"",region:"",country_code:"",postalCode:0};r.title=e[0].titleNoFormatting,r.addressLine=e[0].addressLines.join(", "),r.streetAddress=e[0].streetAddress,r.city=e[0].city,r.region=e[0].region,r.country_code=e[0].country,r.postalCode=e[0].postalCode,r.locale=n.countryToLocal(r.country_code),n._addresses.push(r),t.call(i,r),n.outPropertyChange("addresses")})}else console.error("The local search engine is not initialized")},countryToLocal:function(e){switch(e){case"US":return"en_US";case"GB":return"en_GB";case"FR":return"fr_FR";case"CA":return"fr_CA";case undefined:return"en_US";default:return e.toLowerCase()}},addressToGPSCoordinate:function(e,t,i){if(this.__local_search){var r=[0,0];if(i||(i=this),!e||"string"!=typeof e)return this.ERROR_CODE=2,void t.call(i,null);var n='"'+e+'"',o=this;this._googleLocalSearch(n,function(e){if(e){if(!e[0])return this.ERROR_CODE=5,void t.call(i,null);r[0]=parseFloat(e[0].lat),r[1]=parseFloat(e[0].lng),o._position=r,t.call(i,r.slice()),o.outPropertyChange("position")}})}else console.error("The local search engine is not initialized")},searchAddress:function(e,t,i){if(this.__local_search){if(i||(i=this),!e||"string"!=typeof e)return this.ERROR_CODE=2,void t.call(i,null);var r='"'+e+'"',n=this;this._googleLocalSearch(r,function(e){if(n._addresses=[],!e)return t.call(i,[]),void n.outPropertyChange("addresses");for(var r=0;r<e.length;r++){var o={};o.title=e[r].titleNoFormatting,o.addressLine=e[r].addressLines.join(", "),o.streetAddress=e[r].streetAddress,o.city=e[r].city,o.region=e[r].region,o.country_code=e[r].country,o.postalCode=e[r].postalCode,n._addresses.push(o)}t.call(i,n._addresses.slice()),n.outPropertyChange("addresses")})}else console.error("The local search engine is not initialized")}},util.extendClass(GoogleSearch,core.EventSource),util.defineClassProperties(GoogleSearch,{strAddress:{set:function(e){if(util.isString(e)){this._str_address=e;var t=this;this.searchAddress(e,function(i){t.addressToGPSCoordinate(e,function(e){},this)},this)}}},addresses:{get:function(e){return this._addresses}},position:{set:function(e){util.isArray(e)&&2===e.length&&util.isNumber(e[0])&&util.isNumber(e[1])&&this.GPSCoordinateToAddress(e,function(e){},this)},get:function(){return this._position}},engineLoaded:{get:function(){return this._engine_loaded}}}),data.GoogleSearch=GoogleSearch,RSSItem.prototype={_title:"",_link:"",_description:"",_author:"",_comments:"",_pub_date:"",_category:null,_enclosure:null,_guid:null,_source:null,_image:null,_image_url:"",_category:null,toString:function(){return this.title}},util.defineClassProperties(RSSItem,{title:{get:function(){return this._title}},link:{get:function(){return this._link}},description:{get:function(){return this._description}},author:{get:function(){return this._author}},comments:{get:function(){return this._comments}},pubDate:{get:function(){return this._pub_date}},category:{get:function(){return this._category}},enclosure:{get:function(){return this._enclosure}},guid:{get:function(){return this._guid}},source:{get:function(){return this._source}},image:{get:function(){return this._image}},imageUrl:{get:function(){return this._image_url}}});var RSSFeed=function(e){this.parent=vs.core.EventSource,this.parent(e),this.constructor=RSSFeed};RSSFeed.prototype={_items:null,_title:null,_link:null,_description:null,_language:null,_copyright:null,_managing_editor:null,_web_master:null,_pub_date:null,_last_build_date:null,_generator:null,_docs:null,_ttl:null,_rating:null},util.extendClass(RSSFeed,core.EventSource),util.defineClassProperties(RSSFeed,{items:{get:function(){return this._items}},title:{get:function(){return this._title}},link:{get:function(){return this._link}},description:{get:function(){return this._description}},language:{get:function(){return this._language}},copyright:{get:function(){return this._copyright}},managingEditor:{get:function(){return this._managing_editor}},webMaster:{get:function(){return this._web_master}},pubDate:{get:function(){return this._pub_date}},lastBuildDate:{get:function(){return this._last_build_date}},generator:{get:function(){return this._generator}},docs:{get:function(){return this._docs}},rating:{get:function(){return this._rating}},image:{get:function(){return this._image}},imageUrl:{get:function(){return this._image_url}},category:{get:function(){return this._category}}});var RSSRequester=function(e){this.parent=RSSFeed,this.parent(e),this.constructor=RSSRequester,this._rss=this};RSSRequester.prototype={_url:"",_rss:null,initComponent:function(){RSSFeed.prototype.initComponent.call(this),this._xhr=new core.HTTPRequest,this._xhr.init(),this._xhr.bind("xmlload",this,this.processRSS),this._xhr.bind("loaderror",this,this.processError)},destructor:function(){this._xhr.unbind("xmlload",this,this.processRSS),this._xhr.unbind("loaderror",this,this.processError),free(this._xhr),RSSFeed.prototype.destructor.call(this)},loadRSS:function(){this._xhr.send()},processRSS:function(e){var t=e.data;if(!t&&!(t=(new DOMParser).parseFromString(this._xhr.responseText,"application/xml")))return console.error("Failed to parse rss document that is null."),this.propagate("rssloaderror","document null."),!1;RSSChannel(this,t),this.propagate("rssload",this),this.outPropertyChange()},processError:function(e){e&&e.data&&"failed"===e.data.status&&this.performAlternateRequest?this.performAlternateRequest():this.propagate("rssloaderror")},propertiesDidChange:function(){return this.loadRSS(),!0},performAlternateRequest:_performAlternateYahooPipeRequest},util.extendClass(RSSRequester,RSSFeed),util.defineClassProperties(RSSRequester,{url:{set:function(e){util.isString(e)&&(this._url=e,this._xhr.url=e)}},rss:{get:function(){return this._rss}}}),data.RSSFeed=RSSFeed,data.RSSRequester=RSSRequester,URL.prototype={_src:"",_anchor:"",_query:"",_file:"",_directory:"",_path:"",_relative:"",_port:0,_host:"",_password:"",_user:"",_authority:"",_protocol:"",_query_key:null,__options:{strictMode:!1,key:["_source","_protocol","_authority","_userInfo","_user","_password","_host","_port","_relative","_path","_directory","_file","_query","_anchor"],q:{name:"_query_key",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},parse:function(e){if(util.isString(e)){this._src=e;for(var t=this.__options,i=t.parser[t.strictMode?"strict":"loose"].exec(e),r=14,n=this;r--;)this[t.key[r]]=i[r]||"";this[t.q.name]={},this[t.key[12]].replace(t.q.parser,function(e,i,r){i&&(n[t.q.name][i]=r)}),this.outPropertyChange("src")}}},util.extendClass(URL,core.Object),util.defineClassProperties(URL,{src:{set:function(e){util.isString(e)&&this.parse(e)},get:function(){return this._src}},anchor:{get:function(){return this._anchor}},query:{get:function(){return this._query}},queryKey:{get:function(){return this._query_key}},file:{get:function(){return this._file}},directory:{get:function(){return this._directory}},path:{get:function(){return this._path}},port:{get:function(){return this._port}},relative:{get:function(){return this._relative}},host:{get:function(){return this._host}},password:{get:function(){return this._password}},user:{get:function(){return this._user}},authority:{get:function(){return this._authority}},protocol:{get:function(){return this._protocol}}}),data.URL=URL}(window);