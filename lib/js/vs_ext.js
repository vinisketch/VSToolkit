!function(t,i){function e(t){this.parent=n.ui.View,this.parent(t),this.constructor=e,this.__indicators_list={}}function s(){c.InfoWindow=function(t,i,e,s,o){this.vs_map=t,this.id=i,this.type=e,t&&(this.setCoordinate(s,o),this.setValues({map:this.vs_map._gmap}))},c.InfoWindow.prototype=new google.maps.OverlayView,c.InfoWindow.prototype.destructor=function(){this.setMap(null),this.marker=i,this.vs_map=i},c.InfoWindow.prototype.hide=function(){this.view&&(this.view.style.display="none")},c.InfoWindow.prototype.show=function(){this.view&&(this.view.style.display="block")},c.InfoWindow.prototype.setMarker=function(t){this.marker&&this.unbind("position"),this.marker=t,this.id=this.marker.id,this.type=this.marker.type,this.info=this.marker.info,this.bindTo("position",this.marker._gmarker,"position"),this.instanciateView(this.type,this.info)},c.InfoWindow.prototype.setCoordinate=function(t,i){this.position&&delete this.position,this.position=new google.maps.LatLng(t,i)},c.InfoWindow.prototype.setType=function(t){this.type=t,this.instanciateView(this.type,this.info)},c.InfoWindow.prototype.setInfo=function(t){this.info=t,this.instanciateView(this.type,this.info)},c.InfoWindow.prototype.instanciateView=function(t,i){var e=o.createElement("div"),s=c._anotation_templates_[t];s||(s=c._anotation_templates_.default);var n=s.infoWindow;if(i)for(key in i){var r=i[key];r=r||"",n=n.replace("{"+key+"}",r)}_.safeInnerHTML(e,n),this.view||this.createView(),_.safeInnerHTML(this.view,e.firstElementChild.innerHTML),this.view.className=e.firstElementChild.className},c.InfoWindow.prototype.createView=function(){this.view||(this.view=o.createElement("div"),n.addPointerListener(this.view,r.POINTER_START,this))},c.InfoWindow.prototype.handleEvent=function(t){var i=this;switch(t.type){case r.POINTER_START:if(0===t.targetPointerList.length||t.nbPointers>1)return;return n.addPointerListener(o,r.POINTER_END,this),n.addPointerListener(o,r.POINTER_MOVE,this),this.__start_x=t.targetPointerList[0].pageX,this.__start_y=t.targetPointerList[0].pageY,this.marker&&this.removeMapEvent(),_.addClassName(this.view,"selected"),!1;case r.POINTER_MOVE:if(0===t.targetPointerList.length)return;var e=t.targetPointerList[0].pageX-this.__start_x,s=t.targetPointerList[0].pageY-this.__start_y;return Math.abs(e)+Math.abs(s)<10?(t.preventDefault(),!1):(n.removePointerListener(o,r.POINTER_END,this),n.removePointerListener(o,r.POINTER_MOVE,this),this.marker&&n.scheduleAction(function(){i.initMapEvent()}),_.removeClassName(this.view,"selected"),!1);case r.POINTER_END:return t.stopPropagation(),t.preventDefault(),n.removePointerListener(o,r.POINTER_END,this),n.removePointerListener(o,r.POINTER_MOVE,this),this.marker&&n.scheduleAction(function(){i.initMapEvent()}),_.removeClassName(this.view,"selected"),this.vs_map.annotationSelect(this.id),!1}},c.InfoWindow.prototype.onAdd=function(){this.view||this.createView(),this.getPanes().floatPane.appendChild(this.view);var t=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){t.draw()})]},c.InfoWindow.prototype.onRemove=function(){this.view.parentNode.removeChild(this.view);for(var t=0,i=this.listeners_.length;t<i;++t)google.maps.event.removeListener(this.listeners_[t])},c.InfoWindow.prototype.draw=function(){var t=this.getProjection().fromLatLngToDivPixel(this.get("position")),i=this.view;i.style.display="block",i.style.visibility="hidden";var e=0;if(this.marker){e=10;var s=this.marker._gmarker.getIcon();s&&(e+=s.size.height)}n.scheduleAction(function(){var s=i.offsetWidth,o=i.offsetHeight;i.style.left=t.x-Math.ceil(s/2)+"px",i.style.top=t.y-o-e+"px",i.style.visibility="visible"})},c.InfoWindow.prototype.initMapEvent=function(){if(!this.map_listener){var t=this;this.map_listener=google.maps.event.addListener(this.vs_map._gmap,"click",function(){t.hide()})}},c.InfoWindow.prototype.removeMapEvent=function(){this.map_listener&&(google.maps.event.removeListener(this.map_listener),this.map_listener=i)},c.InfoWindowWithMarker=function(t){this.vs_map=t,this.setValues({map:this.vs_map._gmap}),this.initMapEvent()},_.extendClass(c.InfoWindowWithMarker,c.InfoWindow)}var o=t.document,n=t.vs,_=n.util,r=n.core,a=n.ui,l=(n.fx,n.ext),h=l.ui,d=(l.fx,function(t){this.parent=a.View,this.parent(t),this.constructor=d,this.__ab_a_items=[]});d.STRETCH_NONE=0,d.STRETCH_FILL=1,d.prototype={_stretch:d.STRETCH_NONE,__ab_a_items:i,__ab_a_current_index:i,__ab_a_head_height:33,push:function(t,i){if(t){this.add(t);var e=this._getIndexForChild(t);this.setPanelTitle(e,i)}},add:function(t){if(t){var i,e;t.id||(t.id=n.core.createId()),i=this.__ab_a_items.length,e=this._createView(t,"Section "+(i+1),i),this.view.appendChild(e.dt),a.View.prototype.add.call(this,t,"children",e.dd),this.__ab_a_items.push(e),this._updateSizePanel()}},remove:function(t){var i,e=this._getIndexForChild(t);-1!==e&&(a.View.prototype.remove.call(this,t),(i=this.__ab_a_items[e]).dd.removeChild(t.view),this.view.removeChild(i.dt),n.removePointerListener(i.dt,r.POINTER_START,this),delete i.dt,delete i.dd,delete i,this.__ab_a_items.remove(e),e===this.__ab_a_current_index?(this.__ab_a_current_index=null,this.expandPanel(0)):this._updateSizePanel())},_getIndexForChild:function(t){if(!t)return-1;var i,e;for(i=0;i<this.__ab_a_items.length;i++)if((e=this.__ab_a_items[i])&&e.dd&&e.dd.__child===t)return i;return-1},_createView:function(t,i,e){var s,a={};return a.dt=o.createElement("dt"),_.setElementInnerText(a.dt,i),a.title=i,a.dd=o.createElement("dd"),this._stretch===d.STRETCH_FILL&&(t.position=[0,0]),a.dd.appendChild(t.view),s=e?"collapsed":"expanded",a.dd.setAttribute("class",s),a.dt.setAttribute("class",s),a.dd.__child=t,a.child=t,"collapsed"===s?(a.dd.style.width="100%",a.dd.style.height="0px"):(a.dd.style.width="100%",a.dd.style.height=t._size[1]+"px",this.__ab_a_current_index=e),this._stretch===d.STRETCH_FILL&&(t.size=[this._size[0]-2,this._size[1]]),a.dt.__dd=a.dd,a.dt.__index=e,n.addPointerListener(a.dt,r.POINTER_START,this),a},expandPanel:function(t){var i,e;if(_.isNumber(t)&&t>=0&&t<this.__ab_a_items.length){if(t===this.__ab_a_current_index)return;return(i=this.__ab_a_items[this.__ab_a_current_index])&&(_.removeClassName(i.dt,"expanded"),_.addClassName(i.dt,"collapsed"),_.removeClassName(i.dd,"expanded"),_.addClassName(i.dd,"collapsed"),i.dd.style.height="0px"),i=this.__ab_a_items[t],_.removeClassName(i.dt,"collapsed"),_.addClassName(i.dt,"expanded"),_.removeClassName(i.dd,"collapsed"),_.addClassName(i.dd,"expanded"),this.__ab_a_current_index=t,this._updateSizePanel(),void this.propagate("panel_select",t)}if(_.isString(t))for(e=0;e<this.__ab_a_items.length;e++)if((i=this.__ab_a_items[e]).title===t)return void this.expandPanel(e)},setPanelTitle:function(t,i){var e,s;if(_.isNumber(t)&&t>=0&&t<this.__ab_a_items.length)return e=this.__ab_a_items[t],e.title=i,void _.setElementInnerText(e.dt,i);if(_.isString(t))for(s=0;s<this.__ab_a_items.length;s++)if((e=this.__ab_a_items[s]).title===t)return void this.setPanelTitle(s,i)},show:function(){n.ui.View.prototype.show.call(this),this._updateSizePanel()},refresh:function(){n.ui.View.prototype.refresh.call(this),this._updateSizePanel()},_updateSize:function(){n.ui.View.prototype._updateSize.call(this),this._updateSizePanel()},_updateSizePanel:function(){var t,i;(i=this.__ab_a_items[this.__ab_a_current_index])&&(t=this._size[1],this.__ab_a_head_height=i.dt.offsetHeight,t-=this.__ab_a_items.length*this.__ab_a_head_height+2,i.dd.style.height=t+"px",this._stretch===d.STRETCH_FILL&&(i.child.size=[this._size[0]-2,t]))},handleEvent:function(t){var i,e,s,l=t.target;if(1!==l.nodeType&&(l=l.parentElement),t.type===r.POINTER_START){if(0===t.targetPointerList.length||t.nbPointers>1)return;if(t.stopPropagation(),t.preventDefault(),_.hasClassName(l,"expanded"))return!1;n.addPointerListener(o,r.POINTER_MOVE,this,!1),n.addPointerListener(o,r.POINTER_END,this,!1),this.__touch_start_x=t.targetPointerList[0].pageX,this.__touch_start_y=t.targetPointerList[0].pageY,this.__elem=l,this.__elem_to_unselect&&(_.removeClassName(this.__elem_to_unselect,"selected"),this.__elem_to_unselect=null),_.addClassName(this.__elem,"selected")}else if(t.type===r.POINTER_MOVE){if(0===t.targetPointerList.length)return;t.stopPropagation(),t.preventDefault(),e=t.targetPointerList[0].pageX,i=t.targetPointerList[0].pageY,s=Math.abs(i-this.__touch_start_y)+Math.abs(e-this.__touch_start_x),this.__elem&&s>2*a.View.MOVE_THRESHOLD&&(_.removeClassName(this.__elem,"selected"),this.__elem=null)}else t.type===r.POINTER_END&&(t.stopPropagation(),t.preventDefault(),n.removePointerListener(o,r.POINTER_MOVE,this),n.removePointerListener(o,r.POINTER_END,this),this.__elem&&(_.addClassName(this.__elem,"selected"),this.__elem_to_unselect=this.__elem,_.removeClassName(this.__elem_to_unselect,"selected"),this.__elem_to_unselect=null,_.isNumber(l.__index)&&this.expandPanel(l.__index)),this.__elem=null);return!1}},_.extendClass(d,n.ui.View),_.defineClassProperty(d,"stretch",{set:function(t){_.isNumber(t)&&(t!==d.STRETCH_FILL&&t!==d.STRETCH_NONE||(this._stretch=t,this._stretch===d.STRETCH_FILL?_.addClassName(this.view,"fill"):_.removeClassName(this.view,"fill"),this._updateSizePanel()))},get:function(){return this._stretch}}),h.Accordion=d,e.HORIZONTAL=n.fx.SwipeController.HORIZONTAL,e.VERTICAL=n.fx.SwipeController.VERTICAL,e.prototype={_indicators_visibility:!0,_delegate:null,_orientation:e.HORIZONTAL,_swipe_controller:null,__indicators:null,__selected_indicator:null,__indicators_list:null,__indicators_timer:0,destructor:function(){_.free(this._swipe_controller),n.ui.View.prototype.destructor.call(this)},initComponent:function(){n.ui.View.prototype.initComponent.call(this),this.__indicators=this.view.querySelector(".vs_ext_ui_carousel >.indicators"),n.util.addClassName(this.__indicators,"horizontal"),this._swipe_controller=new n.fx.SwipeController(this),this._swipe_controller.delegate=this,this._swipe_controller.isTactile=!0,this._swipe_controller.animationMode=n.fx.SwipeController.PIXEL,this._swipe_controller.init()},refresh:function(){this._swipe_controller&&this._swipe_controller.refresh&&this._swipe_controller.refresh(),n.ui.View.prototype.refresh.call(this)},controllerViewWillChange:function(t,i,e){this.__indicators_timer&&(clearTimeout(this.__indicators_timer),__indicators_timer=0);var s=i.id,o=this;this.__indicators_timer=setTimeout(function(){o.__selected_indicator&&n.util.removeClassName(o.__selected_indicator,"selected"),o.__selected_indicator=o.__indicators_list[s],n.util.addClassName(o.__selected_indicator,"selected")},500),this._delegate&&this._delegate.carouselViewWillChange&&this._delegate.carouselViewWillChange(i)},add:function(t){n.ui.View.prototype.add.call(this,t,"children"),this.push(t)},push:function(t,i){if(!this.isChild(t)||!this._swipe_controller.isStateExit(t.id)){var e,s=this._swipe_controller.push(t,i);e=o.createElement("span"),this.__indicators.appendChild(e),this.__indicators_list[s]=e}},remove:function(t){if(t&&t.id){var i=this.__indicators_list[t.id];this.__indicators.removeChild(i),delete this.__indicators_list[t.id],n.ui.View.prototype.remove.call(this,t)}},removeAllChildren:function(t){var e=[];for(var s in this.__indicators_list){var o=n.core.Object._obs[s];this.remove(o),t?_.free(o):e.push(o)}return t?i:e},goToNextView:function(){this._swipe_controller.goToNextView()},goToPreviousView:function(){this._swipe_controller.goToPreviousView()},goToView:function(t){this._swipe_controller.goToViewId(t)},goToViewAt:function(t){this._swipe_controller.goToViewAt(t)}},_.extendClass(e,n.ui.View),_.defineClassProperties(e,{size:{set:function(t){t&&_.isArray(t)&&2===t.length&&_.isNumber(t[0])&&_.isNumber(t[1])&&(this._size[0]=t[0],this._size[1]=t[1],this.view&&(this._updateSizeAndPos(),this._swipe_controller&&this._swipe_controller.refresh&&this._swipe_controller.refresh()))},get:function(){var t=this.view;return t&&t.parentNode&&(this._size[0]=t.offsetWidth,this._size[1]=t.offsetHeight),this._size.slice()}},delegate:{set:function(t){this._delegate=t}},indicatorsVisibility:{set:function(t){t?(this._indicators_visibility=!0,_.setElementVisibility(this.__indicators,!0)):(this._indicators_visibility=!1,_.setElementVisibility(this.__indicators,!1))}},isCircular:{set:function(t){this._swipe_controller.isCircular=t},get:function(){return this._swipe_controller.isCircular}},isContinuousSwipe:{set:function(t){this._swipe_controller.isContinuousSwipe=t},get:function(){return this._swipe_controller.isContinuousSwipe}},orientation:{set:function(t){t!==e.HORIZONTAL&&t!==e.VERTICAL||this._orientation!==t&&(t===e.HORIZONTAL?(n.util.removeClassName(this.__indicators,"vertical"),n.util.addClassName(this.__indicators,"horizontal")):(n.util.removeClassName(this.__indicators,"horizontal"),n.util.addClassName(this.__indicators,"vertical")),this._orientation=t,this._swipe_controller.orientation=t)},get:function(){return this._orientation}}}),h.Carousel=e;var c=function(t){this.parent=n.ui.View,this.parent(t),this.constructor=c,this._center=new Array,this._center[0]=48.83763339660763,this._center[1]=2.3397827148437544,c.__google_loaded__||(c.__google_wait_loaded__||(c.__google_wait_loaded__=!0,n.util.importFile("http://maps.google.com/maps/api/js?sensor=true&callback=vs.ext.ui.GMap.__on_laoded",null,null,"js")),c._to_finish_init.push(this)),this.__annotations={}};c.NO_MARKER=0,c.DEVICE_IMAGE_MARKER=1,c.IMAGE_MARKER=2,c._anotation_templates_={},c._anotation_templates_.default={marker:{type:c.DEVICE_IMAGE_MARKER},infoWindow:'<div class="vs_ext_ui_gmap_info">    <div>{title}</div>    <div>{subtitle}</div>  </div>'},c.__google_wait_loaded__=!1,c.__google_loaded__=!1,c._to_finish_init=new Array,c.__on_laoded=function(){var t,i;for(c.__google_loaded__=!0,c.__google_wait_loaded__=!1,s(),t=0,i=c._to_finish_init.length;t<i;t++)c._to_finish_init[t].finishInit();c._to_finish_init=null},c.prototype={_zoom:10,_tilt:-1,_scroll:!0,_tap_to_zoom:!0,_max_zoom:20,_min_zoom:1,_zoom_control:!1,_street_view_control:!1,_center:null,_gmap:null,__init_finished:!1,__annotations:null,destructor:function(){delete this._gmap,n.ui.View.prototype.destructor.call(this)},initComponent:function(){n.ui.View.prototype.initComponent.call(this),c.__google_loaded__&&this.finishInit()},finishInit:function(){var t=new google.maps.LatLng(this._center[0],this._center[1]),i={zoom:this._zoom,center:t,disableDefaultUI:!0,draggable:this._scroll,maxZoom:this._max_zoom,minZoom:this._min_zoom,disableDoubleClickZoom:!this._tap_to_zoom,streetViewControl:this._street_view_control,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},zoomControl:this._zoom_control,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM,style:google.maps.ZoomControlStyle.SMALL},mapTypeControlOptions:{style:google.maps.ControlPosition.HORIZONTAL_BAR},mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU}};this._gmap=new google.maps.Map(this.view,i);var e=this;n.scheduleAction(function(){p(e)})},__init_did_finish:function(){this.__init_finished=!0,this.streetViewControl=this._street_view_control,this.zoomControl=this._zoom_control,this.propagate("mapload")},isReady:function(){return this.__init_finished},getGoogleMapObject:function(){return this._gmap},showCenterMark:function(){this._center_mark||(this._center_mark=new google.maps.Marker({position:new google.maps.LatLng(this._center[0],this._center[1]),icon:"css/kit/mapCenter.png"})),this._center_mark.setMap(this._gmap)},hideCenterMark:function(){this._center_mark&&this._center_mark.setMap(null)},refresh:function(){this._gmap&&(google.maps.event.trigger(this._gmap,"resize"),n.ui.View.prototype.refresh.call(this))},addAnnotation:function(t,i,e,s,o){if(this.__init_finished){_.isString(t)&&t||(t=r.createId());var n=new c.Annotation(this,t,i,e,s,o);return this.__annotations[t]=n,n}},setAnnotationTemplate:function(t,i,e){if(_.isString(t)||t){var s=c._anotation_templates_.default;c._anotation_templates_[t]={marker:_.clone(i||s.marker),infoWindow:_.clone(e||s.infoWindow)}}},removeAnnotation:function(t){!_.isString(t)&&t.id&&(t=t.id);var i=this.__annotations[t];i&&(_.free(i),delete this.__annotations[t])},removeAnnotations:function(){for(var t in this.__annotations)this.removeAnnotation(t)},annotationSelect:function(t){this.propagate("annotationselect",t)}},_.extendClass(c,n.ui.View),_.defineClassProperties(c,{scroll:{set:function(t){this._scroll=!!t,this.__init_finished&&this._gmap.setOptions({draggable:this._scroll})},get:function(){return this._scroll}},tapToZoom:{set:function(t){this._tap_to_zoom=!!t,this.__init_finished&&this._gmap.setOptions({disableDoubleClickZoom:!this._tap_to_zoom})},get:function(){return this._tap_to_zoom}},maxZoom:{set:function(t){n.util.isNumber(t)&&(this._max_zoom=t,this.__init_finished&&this._gmap.setOptions({maxZoom:this._max_zoom}))},get:function(){return this._max_zoom}},minZoom:{set:function(t){n.util.isNumber(t)&&(this._min_zoom=t,this.__init_finished&&this._gmap.setOptions({maxZoom:this._min_zoom}))},get:function(){return this._min_zoom}},zoomControl:{set:function(t){this._zoom_control=!!t,this.__init_finished&&this._gmap.setOptions({zoomControl:this._zoom_control})},get:function(){return this._zoom_control}},zoom:{set:function(t){n.util.isNumber(t)&&this.__init_finished&&(t=Math.floor(t))!==this._zoom&&(this._zoom=t,this._gmap.setZoom(this._zoom))},get:function(){return this._gmap?(this._zoom=this._gmap.getZoom(),this._zoom):-1}},tilt:{set:function(t){n.util.isNumber(t)&&this.__init_finished&&(this._tilt=t,this._gmap.setTilt(t))},get:function(){return this._gmap?(this._tilt=this._gmap.getTilt(),this._tilt):-1}},streetViewControl:{set:function(t){this._street_view_control=!!t,this.__init_finished&&this._gmap.setOptions({streetViewControl:this._street_view_control})},get:function(){return this._street_view_control}},center:{set:function(t){if(this.__init_finished&&t&&n.util.isArray(t)&&2===t.length&&n.util.isNumber(t[0])&&n.util.isNumber(t[1])){this._center[0]=t[0],this._center[1]=t[1];var i=new google.maps.LatLng(t[0],t[1]);this._gmap.setCenter(i),this._center_mark&&this._center_mark.setPosition(i)}},get:function(){if(!this._gmap)return[0,0];var t=this._gmap.getCenter();return this._center[0]=t.lat(),this._center[1]=t.lng(),this._center.slice()}}});var p=function(t){t.__init_did_finish()};c.Annotation=function(i,e,s,o,_,r){this.map=i,this.id=e,this.info=_,this.type=r||"default",this._coordinate=new google.maps.LatLng(s,o);var a=c._anotation_templates_[this.type];if(a||(a=c._anotation_templates_.default),this.image=null,a.marker.type==c.DEVICE_IMAGE_MARKER){var l=t.deviceConfiguration.os;l==n.core.DeviceConfiguration.OS_SYMBIAN?this.image=new google.maps.MarkerImage("css/kit/symbian_marker.png",new google.maps.Size(48,51),new google.maps.Point(0,0),new google.maps.Point(24,48)):l==n.core.DeviceConfiguration.OS_WP7?this.image=new google.maps.MarkerImage("css/kit/wp7_marker.png",new google.maps.Size(15,31),new google.maps.Point(0,0),new google.maps.Point(0,31)):this.image=new google.maps.MarkerImage("css/kit/ios_marker.png",new google.maps.Size(32,41),new google.maps.Point(0,0),new google.maps.Point(8,36))}else a.marker.type==c.IMAGE_MARKER&&(this.image=new google.maps.MarkerImage(a.marker.url));if(this.image){this._gmarker=new google.maps.Marker({position:this._coordinate,icon:this.image,map:i._gmap,animation:google.maps.Animation.DROP});var h=this;google.maps.event.addListener(this._gmarker,"click",function(){h.onselect()})}else this._infoWindow=new c.InfoWindow(this.map,e,s,o,r),this._infoWindow.setCoordinate(s,o),this._infoWindow.setInfo(_)},c.Annotation.prototype={destructor:function(){this._gmarker&&(this._gmarker.setMap(null),delete this._gmarker),this._infoWindow&&free(this._infoWindow),this.image&&delete this.image,delete this._coordinate,this.map=i},onselect:function(){this.showInfoWindow()},showInfoWindow:function(){this.map._infoWindow?this.map._infoWindow.setMarker(this):(this.map._infoWindow=new c.InfoWindowWithMarker(this.map),this.map._infoWindow.setMarker(this))}},_.defineClassProperties(c.Annotation,{coordinate:{set:function(t){(_.isArray(t)||2==t.length)&&(delete this._coordinate,this._coordinate=new google.maps.LatLng(t[0],t[1]),this._gmarker&&this._gmarker.setPosition(this._coordinate))},get:function(){return[this._coordinate.lat(),this._coordinate.lng()]}},info:{set:function(t){this._info=t,this._infoWindow&&this._infoWindow.setInfo(t)},get:function(){return this._info}}}),h.GMap=c,d.prototype.html_template="<dl class='vs_ext_ui_accordion' x-hag-hole='children'></dl> ",e.prototype.html_template="<div class='vs_ext_ui_carousel'>   <div class='views' x-hag-hole='children'></div>   <div class='indicators'></div> </div>",c.prototype.html_template="<div class='vs_ext_ui_gmap'></div>"}(window);